<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAR Image Tracking</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar.js@latest/aframe/build/aframe-ar.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8"></script> <!-- For touch gestures -->
    <style>
        #info-box {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            display: none;
            font-size: 18px;
        }
        #language-switch {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 8px;
            font-size: 16px;
            background: #fff;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }
    </style>
</head>
<body style="margin: 0; overflow: hidden;">

    <!-- Button to switch languages -->
    <button id="language-switch">ðŸ‡¬ðŸ‡§ English</button>

    <!-- Information Box -->
    <div id="info-box"></div>

    <!-- AR Scene -->
    <a-scene
        embedded
        arjs="trackingMethod: best; debugUIEnabled: false;"
        renderer="logarithmicDepthBuffer: true;"
        gesture-detector>

        <!-- Image Marker (Replace with your image marker path) -->
        <a-marker type="pattern" url="pattern-cannon.patt">
            <!-- 3D Model -->
            <a-entity id="model" 
                gltf-model="url(Cannon.glb)" 
                scale="1 1 1" 
                position="0 0 0"
                gesture-handler
                event-set__click="_event: click; _target: #info-box; visible: true;">
            </a-entity>
        </a-marker>

        <!-- Camera -->
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // Language Data
        const facts = {
            "en": "This is a historical artifact found in Malta.",
            "mt": "Dan huwa artifatt storiku misjub f'Malta."
        };
        let currentLang = "en";

        // Language Toggle Button
        document.getElementById("language-switch").addEventListener("click", function () {
            currentLang = (currentLang === "en") ? "mt" : "en";
            this.textContent = (currentLang === "en") ? "ðŸ‡¬ðŸ‡§ English" : "ðŸ‡²ðŸ‡¹ Malti";
        });

        // Show fact when object is clicked
        document.getElementById("model").addEventListener("click", function () {
            let infoBox = document.getElementById("info-box");
            infoBox.textContent = facts[currentLang];
            infoBox.style.display = "block";

            setTimeout(() => {
                infoBox.style.display = "none";
            }, 3000);
        });

        // Gesture Handler for Rotation & Zoom
        AFRAME.registerComponent("gesture-handler", {
            init: function () {
                let el = this.el;
                let hammertime = new Hammer(document.body);
                let scale = 0.2;
                let rotation = { x: 0, y: 0 };

                // Pinch to Zoom
                hammertime.get('pinch').set({ enable: true });
                hammertime.on('pinch', function (ev) {
                    scale = Math.min(1, Math.max(0.1, scale * ev.scale));
                    el.setAttribute('scale', `${scale} ${scale} ${scale}`);
                });

                // Rotate on Drag
                hammertime.get('pan').set({ enable: true });
                hammertime.on('pan', function (ev) {
                    rotation.y += ev.deltaX * 0.1;
                    el.setAttribute('rotation', `0 ${rotation.y} 0`);
                });
            }
        });
    </script>

</body>
</html>